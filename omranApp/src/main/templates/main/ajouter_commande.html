<!DOCTYPE html>
<html style="font-size: 16px;" lang="en"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <title>ajouter_commande</title>
    <link rel="stylesheet" href="/static/nicepage(2).css" media="screen">
    <link rel="stylesheet" href="/static/ajouter_commande.css" media="screen">
    <script class="u-script" type="text/javascript" src="/static/jquery(2).js" defer=""></script>
    <script class="u-script" type="text/javascript" src="/static/nicepage(2).js" defer=""></script>
    <meta name="generator" content="Nicepage 5.6.2, nicepage.com">
    <meta name="referrer" content="origin">
    
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
    
    
    <script type="application/ld+json">
      {"@context": "http://schema.org",
		"@type": "Organization",
		"name": "",
		"logo": "/static/img/default-logo.png"}
</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="ajouter_commande">
    <meta property="og:type" content="website">
  <meta data-intl-tel-input-cdn-path="intlTelInput/"></head>
  <body class="u-body u-xxl-mode" data-lang="en"><header class="u-clearfix u-grey-10 u-header u-header" id="sec-0b00"><div class="u-clearfix u-sheet u-sheet-1">
        <a class="u-align-right u-image u-logo u-image-1" data-image-width="80" data-image-height="40">
          <img src="/static/img/default-logo.png" class="u-logo-image u-logo-image-1">
        </a>
        <a href="home" class="u-align-left u-border-hover-grey-75 u-border-none u-btn u-button-style u-none u-btn-1"><span class="u-file-icon u-icon u-text-custom-color-1 u-icon-1"><img src="/static/img/318477-d74e274b.png" alt=""></span>
          <br>
        </a>
      </div></header> 
    <section class="u-clearfix u-grey-10 u-section-1" id="sec-b75f">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-container-style u-expanded-width-xl u-expanded-width-xxl u-grey-5 u-group u-opacity u-opacity-90 u-radius-14 u-shape-round u-group-1">
          <div class="u-container-layout u-container-layout-1">
            <button id="emporterBtn" class="u-border-none u-btn u-btn-round u-button-style u-palette-5-dark-1 u-radius-15 u-btn-1" onclick="BtnEmporterEvent()"> Emporter </button>
            <button id="aTableBtn" class="u-border-none u-btn u-btn-round u-button-style u-custom-color-2 u-radius-15 u-btn-2"  onclick="BtnAtableEvent()">A table</button>
            
            <div class="u-form u-form-1">
                <div class="u-form-group u-form-select u-label-none u-form-group-1">
                  <label for="select-c85c" class="u-label">Dropdown</label>
                  <div class="u-form-select-wrapper" id="selectTableNumCont" style="display:none;">
                    <select id="selectTableNum" name="tableNum"onchange="selectFunc(this.value)" class="u-input u-input-rectangle u-radius-10 u-white u-input-1" >
                      {% if pageType == 'Editer Command' %}
                        <option hidden value="{{comm.tableNum}}" selected></option>
                      {% endif %}
                      <option value="1">table 1</option>
                      <option value="2">table 2</option>
                      {% if pageType == 'Ajouter Command' %}
                      <option value="-1" selected hidden>numero table</option>
                      {% endif %}
                    </select>
                    <svg class="u-caret u-caret-svg" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="16px" height="16px" viewBox="0 0 16 16" style="fill:currentColor;" xml:space="preserve"><polygon class="st0" points="8,12 2,4 14,4 "></polygon></svg>
                  </div>
                </div>

            </div>
          </div>
        </div>

        <div class="u-clearfix u-gutter-18 u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-container-style u-grey-5 u-layout-cell u-opacity u-opacity-90 u-radius-25 u-shape-round u-size-41 u-layout-cell-1">
                <div class="u-container-layout u-valign-bottom-xs u-container-layout-2">


                  <form class="form_search" onsubmit="event.preventDefault();"> 
                    <input type="search" id="query" name="q" placeholder="Search..." class="search" required oninput="search_func(this)">
                    <button class="icon-button" onclick="void(0);" >
                      <img class="icon-searsh" src="/static/img/search.png" />
                   </button>
                  </form>


                  <div class="u-container-style u-expanded-width-xs u-group u-shape-rectangle u-group-3">
                    <div class="u-container-layout u-container-layout-4">
                    
                      <button type="submit" name="cat" value="1" onclick="update_category_list(this.value)" class="u-align-center-md u-align-center-sm u-align-center-xs u-align-left-lg u-align-left-xl u-align-left-xxl u-border-none u-btn u-btn-round u-button-style u-custom-color-1 u-radius-15 u-btn-4"> &nbsp;traditional</button>
                      <button type="submit" name="cat" value="2" onclick="update_category_list(this.value)" class="u-align-center u-border-none u-btn u-btn-round u-button-style u-palette-5-dark-1 u-radius-15 u-btn-5">fast food</button>
                      <button type="submit" name="cat" value="3" onclick="update_category_list(this.value)" class="u-align-right u-border-none u-btn u-btn-round u-button-style u-palette-5-dark-1 u-radius-15 u-btn-6">les autres</button>
                    
                    </div>
                  </div>
                  <div class="u-container-style u-expanded-width u-group u-radius-20 u-shape-round u-white u-group-4" >
                    <div class="u-container-layout u-container-layout-5" style="display: grid;grid-template-columns: 1fr 1fr 1fr; max-height:200px;" id="products_list">
                      {% for prod in prods %}
                        <div class="u-container-style u-grey-10 u-group u-radius-18 u-shape-round u-group-5">
                        <div class="u-container-layout u-container-layout-6">
                          <h5 class="u-align-center u-text u-text-1">{{prod.prodName}}<br>
                          </h5>
                          <img class="u-align-center u-image u-image-round u-radius-10 u-image-1" src="{{prod.img.url}}" alt="" data-image-width="1280" data-image-height="891">
                          <h4 class="u-align-center u-text u-text-2">{{prod.prodPrix}}<br>
                          </h4>
                          <button id="addprod" value="{{prod.id}},{{prod.prodName}},{{prod.prodPrix}},{{prod.img.url}}" onclick="insertNewPlats(this.value)" class="u-active-custom-color-4 u-border-none u-btn u-btn-round u-button-style u-custom-color-2 u-hover-custom-color-3 u-radius-6 u-btn-7">ajouter<br>
                          </button>
                        </div>
                      </div>
                      {% endfor %}
                    </div>
                  </div>
                </div>
              </div>
              <div class="u-container-style u-grey-5 u-layout-cell u-opacity u-opacity-90 u-radius-25 u-shape-round u-size-19 u-layout-cell-2" style="padding:2px;">
                <div class="u-container-layout u-container-layout-7" >
                  <h4 class="u-text u-text-default u-text-3">liste des commandes<br>
                  </h4>
                  <div class="u-container-style u-expanded-width u-group u-radius-20 u-shape-round u-white u-group-6" style="padding:2px">
                    <div class="u-container-layout u-valign-middle u-container-layout-8" >
                      <form id="commForm" method="post">{% csrf_token %}
                      <div id="oldPlats">
                        {% for plt in comm.prods.all %}
                            <div  class="u-align-center-lg u-align-center-md u-align-center-sm u-align-center-xl u-align-center-xs u-container-style u-grey-10 u-group u-radius-15 u-shape-round u-group-7" id="commPlt{{plt.id}}">
                              <div class="u-container-layout u-container-layout-9">
                                <a id="inceBtn{{plt.id}}" onclick="incrementBtn(this.id)" class="u-align-center u-border-none u-btn u-button-style u-none u-btn-8"><span class="u-file-icon u-icon u-text-custom-color-2 u-icon-1"><img src="/static/img/8371357-627a9a0f.png" alt=""></span>
                                </a>
                                <a id="decreBtn{{plt.id}}" onclick="decrementBtn(this.id)" class="u-align-center u-border-none u-btn u-button-style u-none u-btn-9"><span class="u-file-icon u-icon u-icon-2"><img src="/static/img/4561935.png" alt=""></span>
                                </a>
                                <img class="u-image u-image-round u-radius-10 u-image-2" src="{{plt.img.url}}" alt="" data-image-width="1280" data-image-height="800">
                                <button  class="u-align-center u-border-none u-btn u-button-style u-none u-btn-10" onclick="delePlt('commPlt{{plt.id}}')"><span class="u-file-icon u-icon u-icon-3"><img src="/static/img/3687412.png" alt=""></span>
                                </button>
                                <div class="u-container-style u-group u-radius-10 u-shape-round u-white u-group-8">
                                    <div class="u-container-layout u-valign-middle-lg u-valign-middle-md u-valign-middle-xl u-container-layout-10">
                                     <h4 class="u-align-center u-text u-text-4" id="commPltQnt{{plt.id}}">
                                      {% for key,value in commQnt.items %}
                                        {% if key == plt.id %}
                                          {{value}}
                                        {% endif %}
                                      {% endfor %}
                                  </h4>
                                    </div>
                                </div>
                                <h4 class="u-align-center-xxl u-text u-text-5">
                                    <div style="direction: rtl;">{{plt.prodPrix}} </div>
                                </h4>
                                <h4 class="u-align-center-xxl u-text u-text-6">{{plt.prodName}} <br>
                                </h4>
                              </div>
                            </div>
                             <input hidden type="text" name="prodId_Qnt" value="{{plt.id}}"><!--fl value khass qnt -->
                             
                      {% endfor %}
                      <input type="text" id="typeCommand" name="typeComm" value="-1" hidden>
                    </div>
                      <div id="newPlats">
                      </div>
                        {% if pageType == "Editer Command" %}
                              <input hidden type="submit" id="formSubmit" name="confEdit" value="{{comm.id}}">
                        {% else %}
                              <input hidden type="submit" id="formSubmit" name="confEdit" value="newComm">
                        {% endif %}
                        <input type="text" name="commPrix" id="commPrixInput" hidden>
                    </form>
                    </div>
                    
                  </div>
                  <div class="totalPrix">
                    <h5 style="font-size: 1.6em;margin-right:1.6em;text-decoration: underline;">TOTAL :</h5>
                    <h4 id="commPriceTag" style="font-weight: bold;font-size:1.6em">{{comm.commPrice}} DA</h4>
                    
                </div>
                  <button  onclick="submitTrigger()" class="u-align-center u-border-none u-btn u-btn-round u-button-style u-custom-color-1 u-radius-15 u-btn-11">ajouter</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    
    
    
  
</body>
<script>
  function selectFunc(value){
    document.getElementById('typeCommand').value = value
  }

  function incrementBtn(platId){
    platId = platId.split('inceBtn')[1]
    qntField = document.getElementById('commPltQnt'+platId);
    qntField.textContent = parseInt(qntField.textContent)+1;
  }
  function decrementBtn(platId){
    platId = platId.split('decreBtn')[1]
    qntField = document.getElementById('commPltQnt'+platId);
    qntField.textContent = parseInt(qntField.textContent)-1;
  }
  function BtnEmporterEvent(){
    document.getElementById('emporterBtn').style='background-color:green'
    document.getElementById('aTableBtn').style='background-color:gray'

    document.getElementById('typeCommand').value="emporter"
    document.getElementById('selectTableNumCont').style='display:none'
    console.log('TC val '+document.getElementById('typeCommand').value)
  }

  function BtnAtableEvent(){
    document.getElementById('selectTableNumCont').style='display:block'
  }
  
  function submitTrigger(){
      selectValue = document.getElementById('selectTableNum')
      document.getElementById('formSubmit').click();
      commForm = document.getElementById('commForm')
      // console.log(document.getElementById('typeCommand').value)
    }

    function delePlt(divName){
      document.getElementById(divName).remove();
    }

    function insertNewPlats(value){
      newPlts = document.getElementById('newPlats');
      var [platId,platName,platPrix,platImg] = value.split(',');
      commPrice = document.getElementById('commPriceTag')
      commPricetxt = commPrice.textContent.split(' DA')
      commPrxInput = document.getElementById('commPrixInput')

      if(document.getElementById('commPlt'+platId) != null){
        qntField = document.getElementById('commPltQnt'+platId);
        qntField.textContent = parseInt(qntField.textContent)+1;
        
        idQntinputVal = document.getElementById('platIdQnt'+platId)
        document.getElementById('platIdQnt'+platId).value= platId+","+(parseInt(idQntinputVal.value.split(',')[1])+1)
        totalPrx = (parseInt(commPricetxt)+parseInt(platPrix))
        commPrice.textContent = totalPrx+' DA'
        document.getElementById('commPrixInput').value = totalPrx
      }else{
        if(commPricetxt[0] == ' ' || commPricetxt[0] == ''){
          commPrice.textContent = platPrix+' DA'
          document.getElementById('commPrixInput').value = platPrix
        }else{
          commPrice.textContent = (parseInt(commPricetxt)+ parseInt(platPrix))+' DA'
          document.getElementById('commPrixInput').value = (parseInt(commPricetxt)+ parseInt(platPrix))
        }
        newPlts.innerHTML +=`<div  class="u-align-center-lg u-align-center-md u-align-center-sm u-align-center-xl u-align-center-xs u-container-style u-grey-10 u-group u-radius-15 u-shape-round u-group-7" id="commPlt`+platId+`">
                                <div class="u-container-layout u-container-layout-9">
                                  <a  class="u-align-center u-border-none u-btn u-button-style u-none u-btn-8"><span class="u-file-icon u-icon u-text-custom-color-2 u-icon-1"><img src="/static/img/8371357-627a9a0f.png" alt=""></span>
                                  </a>
                                  <a  class="u-align-center u-border-none u-btn u-button-style u-none u-btn-9"><span class="u-file-icon u-icon u-icon-2"><img src="/static/img/4561935.png" alt=""></span>
                                  </a>
                                  <img class="u-image u-image-round u-radius-10 u-image-2" src="`+platImg+`" alt="" data-image-width="1280" data-image-height="800">
                                  <button onclick="delePlt('commPlt`+platId+`')" class="u-align-center u-border-none u-btn u-button-style u-none u-btn-10"><span class="u-file-icon u-icon u-icon-3"><img src="/static/img/3687412.png" alt=""></span>
                                  </button>
                                  <div class="u-container-style u-group u-radius-10 u-shape-round u-white u-group-8">
                                      <div class="u-container-layout u-valign-middle-lg u-valign-middle-md u-valign-middle-xl u-container-layout-10">
                                      <h4 class="u-align-center u-text u-text-4" id="commPltQnt`+platId+`">1</h4>
                                      </div>
                                  </div>
                                  <h4 class="u-align-center-xxl u-text u-text-5">
                                      <div style="direction: rtl;">`+platPrix+` </div>
                                  </h4>
                                  <h4 class="u-align-center-xxl u-text u-text-6">`+platName+` <br>
                                  </h4>
                                </div>
                              </div>
                              <input id="platIdQnt`+platId+`" hidden type="text" name="prodId_Qnt" value="`+platId+`,1">`
    }
    }
</script>


<script>
function update_category_list(value){
  
  products_list= document.getElementById("products_list");
 $.ajax({
          type: 'POST',
          url: '/update_category_list',
          data: {
            'data': value,
          },
          success: function(response) {
            s=""
       for (let i = 0; i < response.data.length; i++) {

              s+=`<div class="u-container-style u-grey-10 u-group u-radius-18 u-shape-round u-group-5">
                        <div class="u-container-layout u-container-layout-6">
                          <h5 class="u-align-center u-text u-text-1">${response.data[i].prodName}<br>
                          </h5>
                          <img class="u-align-center u-image u-image-round u-radius-10 u-image-1" src="${response.data[i].img}" alt="" data-image-width="1280" data-image-height="891">
                          <h4 class="u-align-center u-text u-text-2">${response.data[i].prodPrix}<br>
                          </h4>
                          <button id="addprod" value="${response.data[i].id},${response.data[i].prodName},${response.data[i].prodPrix},${response.data[i].img}" onclick="insertNewPlats(this.value)" class="u-active-custom-color-4 u-border-none u-btn u-btn-round u-button-style u-custom-color-2 u-hover-custom-color-3 u-radius-6 u-btn-7">ajouter<br>
                          </button>
                        </div>
                      </div>`
              
            } 
       products_list.innerHTML=s  

          }});

}

</script>

<script>
  function search_func(input){
  // Get the search field element by its ID
   

    executeFunction(input.value);
  
}

function executeFunction(data) {
      
    products_list= document.getElementById("products_list");
    
    $.ajax({
      type: 'POST',
      url: '/search_product_function',
      data: {
        'data': data,
      },
      success: function(response) {
        s=""
   for (let i = 0; i < response.data.length; i++) {
    s+=`<div class="u-container-style u-grey-10 u-group u-radius-18 u-shape-round u-group-5">
                        <div class="u-container-layout u-container-layout-6">
                          <h5 class="u-align-center u-text u-text-1">${response.data[i].prodName}<br>
                          </h5>
                          <img class="u-align-center u-image u-image-round u-radius-10 u-image-1" src="${response.data[i].img}" alt="" data-image-width="1280" data-image-height="891">
                          <h4 class="u-align-center u-text u-text-2">${response.data[i].prodPrix}<br>
                          </h4>
                          <button id="addprod" value="${response.data[i].id},${response.data[i].prodName},${response.data[i].prodPrix},${response.data[i].img}" onclick="insertNewPlats(this.value)" class="u-active-custom-color-4 u-border-none u-btn u-btn-round u-button-style u-custom-color-2 u-hover-custom-color-3 u-radius-6 u-btn-7">ajouter<br>
                          </button>
                        </div>
                      </div>`


    
   } 
   products_list.innerHTML=s     
    
        
  },
  error: function(xhr, textStatus, errorThrown) {
    console.log("Error sending data:", errorThrown);
  }
    });
    

}
</script>
</html>